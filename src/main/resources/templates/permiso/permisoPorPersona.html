<!DOCTYPE html>
<html lang="en">
<head>
	<title>Sistema integrador</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<base href="/">
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">	
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/noui/nouislider.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->
	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css">

</head>

	<style>
		select{
			width:100%;
		}
		
		.wrap-contact100{
			width: 100%;
		}
		
		table caption{
			caption-side:top;
		}
		
	</style>
<body>

	<nav th:if="${admin==true}" class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #f4623a;"
	th:include="nav_admin :: div"></nav>
			
	<nav th:if="${audit==true}" class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #f4623a;"
	th:include="nav_audit :: div"></nav>
	
	<nav th:if="${anonimo==true}" class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #f4623a;"
	th:include="nav_anonimo :: div"></nav>
	
	<div class="container-contact100">
            		
            <div class="wrap-contact100">
            <div id= "message" class="alert alert-dismissible fade show " role="alert" style="display: none;">
            </div>
			<form action="#" th:action="@{/permiso/by_Persona}" method="post" class="contact100-form validate-form">
				<span class="contact100-form-title">
					Buscar permiso por persona
				</span>
				
				<div class="col-9">
					<label class="form-label" for="dni">Documento:</label>
       				<input class="form-control" type="text" name="dni" placeholder="Ingrese su nro. documento" required>
    			</div>


				<div class="col-3">
					<button type="submit" class="btn btn-success" id="button" style="margin-top:30px;"><i class="fa fa-search" aria-hidden="true"></i> Buscar</button>					
				</div>
		</form> 
		
		<div class="table-responsive">
			<table id="tabla1" class="table table-striped table-bordered border-primary">
				<caption>Permisos Periodo </caption>
				<thead>								
					<tr>
						<th scope="col">Id</th>
						<th scope="col">Pedido</th>
						<th scope="col">Fecha</th>
						<th scope="col">Cant. días</th>
						<th scope="col">Vacaciones</th>
						<th scope="col">Rodado</th>
						<th>QR</th>
					</tr>	 
				</thead>
				<tbody>
					<tr th:each="permiso : ${permisosPeriodo}">
						<td id="idTd1" scope="row" th:text="${permiso.idPermiso}"></td>
						<td th:text="${permiso.pedido}"></td>
						<td th:text="${permiso.fecha}" class="text-center"></td>
						<td th:text="${permiso.cantDias}" class="text-center"></td>
						<td th:if="${permiso.vacaciones==true}" th:text="Si" class="text-center"></td>
						<td th:if="${permiso.vacaciones==false}" th:text="No" class="text-center"></td>
						<td th:text="${permiso.rodado}"></td>
						<td><input type="button" id="qr" class= "btn btn-primary" value="GENERAR QR"></input></td>	 		 
					</tr>
				</tbody>
			</table>
		</div>
		<div class="table-responsive">
			<table id="tabla2" class="table ">
				<caption>Permisos Diario </caption>
				<thead>								
					<tr>
						<th scope="col">Id</th>
						<th scope="col">Pedido</th>
						<th scope="col">Fecha</th>
						<th scope="col">Motivo</th>
						<th>QR</th>
					</tr>	 
				</thead>
				<tbody>
					<tr th:each="permiso : ${permisosDiario}">
						<td id="idTd2" scope="row" th:text="${permiso.idPermiso}"></td>
						<td th:text="${permiso.pedido}"></td>
						<td th:text="${permiso.fecha}" class="text-center"></td>
						<td th:text="${permiso.motivo}" class="text-center"></td>	 
						<!-- 
						
												<td><img th.src="@{/qr/qrcode/${permiso.idPermiso}}"   width="200" height="200"></td>
												<td><img th.src="@{/qr/generateQRCode/${permiso.idPermiso}}"   width="200" height="200"></td>
						
						 -->
						<td><input type="button" id="qrDiario" class= "btn btn-primary" value="GENERAR QR"></input></td>	 		 
					</tr>
				</tbody>
			</table>
		</div>				
	</div>
	</div>
	
	<footer class="bg-dark py-5">
    <div class="container">
        <div class="small text-center text-muted">
            Copyright &copy;
            <!-- This script automatically adds the current year to your website footer-->
            <!-- (credit: https://updateyourfooter.com/)-->
            <script>
                document.write(new Date().getFullYear());
            </script>
            - Universidad Nacional de Lanús
        </div>
    </div>
	</footer>

<!--===============================================================================================-->
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
	
<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
	
	<script>
	$(document).ready(function(){

	    if( $("#idTd1").text() == ""){
	        $("#tabla1").hide(); //Oculta la tabla
	    }
	    
	    if( $("#idTd2").text() == ""){
	        $("#tabla2").hide(); //Oculta la tabla
	    }
	    
	});
	</script>
		<script>
		
		$(function(){
		    //FUNCIÓN PARA MANIPULAR LOS ESTILOS DE LOS MENSAJES DE ALERTA
			 function estiloMensaje(status) {
			      //CAMBIO COLOR DEL MENSAJE
			      $('#message').removeClass("alert alert-success");
			      $('#message').removeClass("alert alert-danger");
			      $('#message').addClass(status);
			      //ACTIVA EL MENSAJE
			      $('#message').css({display: "block"});
			      $('#message').fadeIn();     
			      setTimeout(function() {
			      $("#message").fadeOut();           
			      },8000);
			    }
			 
			 console.log ("SCRIPT");
			  $('#qrDiario').on('click', function(event){
			    $.ajax({
				  method:"GET",
			      url: "/qr/generateAndDownloadQRCode",
			      data: 
			    	  { codeText: $("#idTd2").html()
			    	  },
			      success:function(data)
			      {
			        estiloMensaje("alert alert-success");
			        $('#message').html(data);	      
			      },
			      error:function(data){
			          estiloMensaje("alert alert-danger");
			          $('#message').html('Error: No se pudo generar el QR');
			       
			      }
			    })
			  });
			  
			  $('#qr').on('click', function(event){
				    $.ajax({
					  method:"GET",
				      url: "/qr/generateAndDownloadQRCode",
				      data: 
				      { codeText: $("#idTd1").html()
			    	  },
				      success:function(data)
				      {
				        estiloMensaje("alert alert-success");
				        $('#message').html(data);	      
				      },
				      error:function(data){
				          estiloMensaje("alert alert-danger");
				          $('#message').html('Error: No se pudo generar el QR');
				       
				      }
				    })
				  });
			});
		</script>

	
	
	

	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
	<script type="text/javascript">
        $(function() {
            $('#datetimepicker1').datetimepicker();
        });
    </script>
	
	
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
	
<!--===============================================================================================-->
	<script src="/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>

	<script>
		$('.js-pscroll').each(function(){
			var ps = new PerfectScrollbar(this);

			$(window).on('resize', function(){
				ps.update();
			})
		});
			
		
	</script>
<!--===============================================================================================-->
	<script src="/js/main-grilla.js"></script>
	
	<!--===============================================================================================-->
	
	<script>
		$(".js-select2").each(function(){
			$(this).select2({
				minimumResultsForSearch: 20,
				dropdownParent: $(this).next('.dropDownSelect2')
			});


			$(".js-select2").each(function(){
				$(this).on('select2:close', function (e){
					if($(this).val() == "Please chooses") {
						$('.js-show-service').slideUp();
					}
					else {
						$('.js-show-service').slideUp();
						$('.js-show-service').slideDown();
					}
				});
			});
		})
	</script>
<!--===============================================================================================-->
	<script src="vendor/daterangepicker/moment.min.js"></script>
	<script src="vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
	<script src="vendor/noui/nouislider.min.js"></script>
	<script>
	    var filterBar = document.getElementById('filter-bar');

	    noUiSlider.create(filterBar, {
	        start: [ 1500, 3900 ],
	        connect: true,
	        range: {
	            'min': 1500,
	            'max': 7500
	        }
	    });

	    var skipValues = [
	    document.getElementById('value-lower'),
	    document.getElementById('value-upper')
	    ];

	    filterBar.noUiSlider.on('update', function( values, handle ) {
	        skipValues[handle].innerHTML = Math.round(values[handle]);
	        $('.contact100-form-range-value input[name="from-value"]').val($('#value-lower').html());
	        $('.contact100-form-range-value input[name="to-value"]').val($('#value-upper').html());
	    });
	</script>
<!--===============================================================================================-->
	<script src="js/main.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script>


</body>
</html>